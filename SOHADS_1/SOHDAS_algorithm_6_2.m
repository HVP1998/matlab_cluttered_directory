clc;clear;close all;
% ******************注释*************************
% 本程序旨在验证求解带有参数的方程或方程组
% ******************注释*************************
% syms a b c x y;
% sum=a*x^2+b*x+c;
% x=solve(sum==0)
syms x k U beta;
syms c1 c2 c3 c4 c5 c6 c7 c8 c9 c10 c11 c12 c13 c14 c15 c16 c17 c18 c19 c20 c21 c22 c23;
% *****************************************************第五次迭代一阶位移*********************************************************
A1_5_1_a_3=-(U^3*beta^2*k^3*x*exp(-k*x*1i)*(k*x + 2i))/32;
A1con_5_1_a_3=-(U^3*beta^2*k^3*x*exp(k*x*1i)*(k*x-2i))/32;
A1_5_2_a_5=(U^5*beta^4*k^5*x*exp(-k*x*1i)*(11*k^3*x^3 + k^2*x^2*72i - 178*k*x - 170i))/6144;
A1con_5_2_a_5=(U^5*beta^4*k^5*x*exp(k*x*1i)*(11*k^3*x^3-k^2*x^2*72i - 178*k*x+170i))/6144;
A1_5_3_a_7=-(U^7*beta^6*k^7*x*exp(-k*x*1i)*(1472*k^5*x^5 + k^4*x^4*16176i + 25820*k^3*x^3 + k^2*x^2*189140i + 182295*k*x + 69270i))/47185920;
A1con_5_3_a_7=-(U^7*beta^6*k^7*x*exp(k*x*1i)*(1472*k^5*x^5 - k^4*x^4*16176i + 25820*k^3*x^3 - k^2*x^2*189140i + 182295*k*x - 69270i))/47185920;
A1_5_4_a_9=-(U^9*beta^8*k^9*x*exp(-k*x*1i)*(912*k^7*x^7 - k^6*x^6*6944i + 118208*k^5*x^5 - k^4*x^4*92776i + 1275295*k^3*x^3 + k^2*x^2*817580i + 985840*k*x + 778540i))/3019898880;
A1con_5_4_a_9=-(U^9*beta^8*k^9*x*exp(k*x*1i)*(912*k^7*x^7 + k^6*x^6*6944i + 118208*k^5*x^5 + k^4*x^4*92776i + 1275295*k^3*x^3 - k^2*x^2*817580i + 985840*k*x - 778540i))/3019898880;
A1_5_5_a_11=-(U^11*beta^10*k^11*x*exp(-k*x*1i)*(- 254016*k^9*x^9 + k^8*x^8*1071840i - 20425860*k^7*x^7 + k^6*x^6*94848360i + 49546210*k^5*x^5 + k^4*x^4*232135260i + 310985325*k^3*x^3 + k^2*x^2*908914650i + 1079648325*k*x - 418022325i))/30440580710400;
A1con_5_5_a_11=-(U^11*beta^10*k^11*x*exp(k*x*1i)*(- 254016*k^9*x^9 - k^8*x^8*1071840i - 20425860*k^7*x^7 - k^6*x^6*94848360i + 49546210*k^5*x^5 - k^4*x^4*232135260i + 310985325*k^3*x^3 - k^2*x^2*908914650i + 1079648325*k*x + 418022325i))/30440580710400;
A1_5_1_b_5=-(U^5*beta^4*k^5*x*exp(-k*x*1i)*(9*k^3*x^3 + k^2*x^2*36i + 10*k*x + 18i))/6144;
A1con_5_1_b_5=-(U^5*beta^4*k^5*x*exp(k*x*1i)*(9*k^3*x^3 - k^2*x^2*36i + 10*k*x - 18i))/6144;
A1_5_2_b_7=-(U^7*beta^6*k^7*x*exp(-k*x*1i)*(- 1425*k^5*x^5 - k^4*x^4*468i - 21250*k^3*x^3 + k^2*x^2*69880i + 13990*k*x + 1410i))/14745600;
A1con_5_2_b_7=-(U^7*beta^6*k^7*x*exp(k*x*1i)*(- 1425*k^5*x^5 + k^4*x^4*468i - 21250*k^3*x^3 - k^2*x^2*69880i + 13990*k*x - 1410i))/14745600;
A1_5_3_b_9=-(U^9*beta^8*k^9*x*exp(-k*x*1i)*(123984*k^7*x^7 + k^6*x^6*540576i + 4080384*k^5*x^5 + k^4*x^4*6411048i + 6430011*k^3*x^3 + k^2*x^2*38232208i + 10666684*k*x - 1528464i))/63417876480;
A1con_5_3_b_9=-(U^9*beta^8*k^9*x*exp(k*x*1i)*(123984*k^7*x^7 - k^6*x^6*540576i + 4080384*k^5*x^5 - k^4*x^4*6411048i + 6430011*k^3*x^3 - k^2*x^2*38232208i + 10666684*k*x + 1528464i))/63417876480;
A1_5_4_b_11=-(U^11*beta^10*k^11*x*exp(-k*x*1i)*(- 381024*k^9*x^9 - k^8*x^8*3893904i - 4613490*k^7*x^7 - k^6*x^6*60785244i + 125405091*k^5*x^5 - k^4*x^4*54621924i + 423661910*k^3*x^3 + k^2*x^2*495727400i + 153515670*k*x + 34388130i))/30440580710400;
A1con_5_4_b_11=-(U^11*beta^10*k^11*x*exp(k*x*1i)*(- 381024*k^9*x^9 + k^8*x^8*3893904i - 4613490*k^7*x^7 + k^6*x^6*60785244i + 125405091*k^5*x^5 + k^4*x^4*54621924i + 423661910*k^3*x^3 - k^2*x^2*495727400i + 153515670*k*x - 34388130i))/30440580710400;
A1_5_1_c_7=-(U^7*beta^6*k^7*x*exp(-k*x*1i)*(360*k^5*x^5 + k^4*x^4*1404i + 3450*k^3*x^3 + k^2*x^2*1370i - 3625*k*x + 4725i))/1474560;
A1con_5_1_c_7=-(U^7*beta^6*k^7*x*exp(k*x*1i)*(360*k^5*x^5 - k^4*x^4*1404i + 3450*k^3*x^3 - k^2*x^2*1370i - 3625*k*x - 4725i))/1474560;
A1_5_2_c_9=(U^9*beta^8*k^9*x*exp(-k*x*1i)*(11612160*k^7*x^7 + k^6*x^6*41817600i + 136536960*k^5*x^5 - k^4*x^4*738620064i - 1809850490*k^3*x^3 + k^2*x^2*1730339450i + 4088863415*k*x - 4310922315i))/2536715059200;
A1con_5_2_c_9=(U^9*beta^8*k^9*x*exp(k*x*1i)*(11612160*k^7*x^7 - k^6*x^6*41817600i + 136536960*k^5*x^5 + k^4*x^4*738620064i - 1809850490*k^3*x^3 - k^2*x^2*1730339450i + 4088863415*k*x + 4310922315i))/2536715059200;
A1_5_3_c_11=-(U^11*beta^10*k^11*x*exp(-k*x*1i)*(10450944*k^9*x^9 + k^8*x^8*71318016i + 495071136*k^7*x^7 + k^6*x^6*1406567520i + 2647239420*k^5*x^5 + k^4*x^4*7018411722i + 8299146485*k^3*x^3 + k^2*x^2*995696030i - 10199924175*k*x + 11606361375i))/487049291366400;
A1con_5_3_c_11=-(U^11*beta^10*k^11*x*exp(k*x*1i)*(10450944*k^9*x^9 - k^8*x^8*71318016i + 495071136*k^7*x^7 - k^6*x^6*1406567520i + 2647239420*k^5*x^5 - k^4*x^4*7018411722i + 8299146485*k^3*x^3 - k^2*x^2*995696030i - 10199924175*k*x - 11606361375i))/487049291366400;
A1_5_3=A1_5_1_a_3;
A1con_5_3=A1con_5_1_a_3;
A1_5_5=A1_5_2_a_5+A1_5_1_b_5;
A1con_5_5=A1con_5_2_a_5+A1con_5_1_b_5;
A1_5_7=A1_5_3_a_7+A1_5_2_b_7+A1_5_1_c_7;
A1con_5_7=A1con_5_3_a_7+A1con_5_2_b_7+A1con_5_1_c_7;
A1_5_9=A1_5_4_a_9+A1_5_3_b_9+A1_5_2_c_9;
A1con_5_9=A1con_5_4_a_9+A1con_5_3_b_9+A1con_5_2_c_9;
A1_5_11=A1_5_5_a_11+A1_5_4_b_11+A1_5_3_c_11;
A1con_5_11=A1con_5_5_a_11+A1con_5_4_b_11+A1con_5_3_c_11;

A1_5=U*exp(-1i*k*x)+A1_5_3+A1_5_5+A1_5_7+A1_5_9+A1_5_11;
A1_5_x=diff(A1_5,x,1);
A1_5_xx=diff(A1_5,x,2);
A1con_5=U*exp(1i*k*x)+A1con_5_3+A1con_5_5+A1con_5_7+A1con_5_9+A1con_5_11;
A1con_5_x=diff(A1con_5,x,1);
A1con_5_xx=diff(A1con_5,x,2);
% *****************************************************第五次迭代二阶位移*********************************************************
A2_5_1=(U^2*beta*k^2*x*exp(-k*x*2i))/8;
A2con_5_1=(U^2*beta*k^2*x*exp(k*x*2i))/8;
A2_5_2=-(U^4*beta^3*k^4*x*exp(-k*x*2i)*(2*k^2*x^2 + k*x*9i - 8))/192;
A2con_5_2=-(U^4*beta^3*k^4*x*exp(k*x*2i)*(2*k^2*x^2 - k*x*9i - 8))/192;
A2_5_3=-(U^6*beta^5*k^6*x*exp(-k*x*2i)*(1728*k^4*x^4 + k^3*x^3*8952i - 9208*k^2*x^2 + k*x*18042i - 23299))/2949120;
A2con_5_3=-(U^6*beta^5*k^6*x*exp(k*x*2i)*(1728*k^4*x^4 - k^3*x^3*8952i - 9208*k^2*x^2 - k*x*18042i - 23299))/2949120;
A2_5_4=(U^8*beta^7*k^8*x*exp(-k*x*2i)*(11512320*k^6*x^6 - k^5*x^5*10586240i + 86812992*k^4*x^4 - k^3*x^3*403709600i + 532493360*k^2*x^2 - k*x*153014750i + 226904125))/211392921600;
A2con_5_4=(U^8*beta^7*k^8*x*exp(k*x*2i)*(11512320*k^6*x^6 + k^5*x^5*10586240i + 86812992*k^4*x^4 + k^3*x^3*403709600i + 532493360*k^2*x^2 + k*x*153014750i + 226904125))/211392921600;
A2_5_5=-(U^10*beta^9*k^10*x*exp(-k*x*2i)*(29191680*k^8*x^8 + k^7*x^7*83885760i + 745426560*k^6*x^6 + k^5*x^5*2746843680i - 109166736*k^4*x^4 + k^3*x^3*9346975680i - 7403656120*k^2*x^2 + k*x*2079789390i - 2370095805))/30440580710400;
A2con_5_5=-(U^10*beta^9*k^10*x*exp(k*x*2i)*(29191680*k^8*x^8 - k^7*x^7*83885760i + 745426560*k^6*x^6 - k^5*x^5*2746843680i - 109166736*k^4*x^4 - k^3*x^3*9346975680i - 7403656120*k^2*x^2 - k*x*2079789390i - 2370095805))/30440580710400;
A2_5_6=-(U^12*beta^11*k^12*x*exp(-k*x*2i)*(- 3121348608*k^10*x^10 - k^9*x^9*30349541376i + 19383992320*k^8*x^8 - k^7*x^7*502196808960i + 1586121320960*k^6*x^6 + k^5*x^5*993841242240i + 3701692764000*k^4*x^4 + k^3*x^3*7696444371000i - 3506369328000*k^2*x^2 + k*x*1310910158250i - 827161317675))/685765402243891200;
A2con_5_6=-(U^12*beta^11*k^12*x*exp(k*x*2i)*(- 3121348608*k^10*x^10 + k^9*x^9*30349541376i + 19383992320*k^8*x^8 + k^7*x^7*502196808960i + 1586121320960*k^6*x^6 - k^5*x^5*993841242240i + 3701692764000*k^4*x^4 - k^3*x^3*7696444371000i - 3506369328000*k^2*x^2 - k*x*1310910158250i - 827161317675))/685765402243891200;

A2_5=A2_5_1+A2_5_2+A2_5_3+A2_5_4+A2_5_5+A2_5_6;
A2_5_x=diff(A2_5,x,1);
A2_5_xx=diff(A2_5,x,2);
A2con_5=A2con_5_1+A2con_5_2+A2con_5_3+A2con_5_4+A2con_5_5+A2con_5_6;
A2con_5_x=diff(A2con_5,x,1);
A2con_5_xx=diff(A2con_5,x,2);
% *****************************************************第五次迭代三阶位移*********************************************************
A3_5_1=(U^3*beta^2*k^3*x*exp(-k*x*3i)*(3*k*x + 4i))/96;
A3con_5_1=(U^3*beta^2*k^3*x*exp(k*x*3i)*(3*k*x - 4i))/96;
A3_5_2=-(U^5*beta^4*k^5*x*exp(-k*x*3i)*(72*k^3*x^3 + k^2*x^2*390i - 687*k*x - 338i))/13824;
A3con_5_2=-(U^5*beta^4*k^5*x*exp(k*x*3i)*(72*k^3*x^3 - k^2*x^2*390i - 687*k*x + 338i))/13824;
A3_5_3=-(U^5*beta^4*k^5*x*exp(-k*x*3i)*(9*k^3*x^3 + k^2*x^2*60i - 96*k*x - 52i))/18432;
A3con_5_3=-(U^5*beta^4*k^5*x*exp(k*x*3i)*(9*k^3*x^3 - k^2*x^2*60i - 96*k*x + 52i))/18432;
A3_5_4=(U^7*beta^6*k^7*x*exp(-k*x*3i)*(1396224*k^5*x^5 + k^4*x^4*5325696i - 13023360*k^3*x^3 - k^2*x^2*43820880i + 70218150*k*x + 33259255i))/10192158720;
A3con_5_4=(U^7*beta^6*k^7*x*exp(k*x*3i)*(1396224*k^5*x^5 - k^4*x^4*5325696i - 13023360*k^3*x^3 + k^2*x^2*43820880i + 70218150*k*x - 33259255i))/10192158720;
A3_5_5=-(U^9*beta^8*k^9*x*exp(-k*x*3i)*(- 22425984*k^7*x^7 + k^6*x^6*138786048i + 829906560*k^5*x^5 + k^4*x^4*7608680352i - 11312102970*k^3*x^3 + k^2*x^2*1126422570i - 9963327045*k*x - 4304780165i))/13698261319680;
A3con_5_5=-(U^9*beta^8*k^9*x*exp(k*x*3i)*(- 22425984*k^7*x^7 - k^6*x^6*138786048i + 829906560*k^5*x^5 - k^4*x^4*7608680352i - 11312102970*k^3*x^3 - k^2*x^2*1126422570i - 9963327045*k*x + 4304780165i))/13698261319680;
A3_5_6=-(U^11*beta^10*k^11*x*exp(-k*x*3i)*(10637568*k^9*x^9 + k^8*x^8*65681280i + 118195200*k^7*x^7 + k^6*x^6*615023280i + 3568396410*k^5*x^5 + k^4*x^4*15494236335i - 17053654725*k^3*x^3 + k^2*x^2*2482848300i - 13709120475*k*x - 5707492175i))/469654673817600;
A3con_5_6=-(U^11*beta^10*k^11*x*exp(k*x*3i)*(10637568*k^9*x^9 - k^8*x^8*65681280i + 118195200*k^7*x^7 - k^6*x^6*615023280i + 3568396410*k^5*x^5 - k^4*x^4*15494236335i - 17053654725*k^3*x^3 - k^2*x^2*2482848300i - 13709120475*k*x + 5707492175i))/469654673817600;

A3_5=A3_5_1+A3_5_2+A3_5_3+A3_5_4+A3_5_5+A3_5_6;
A3_5_x=diff(A3_5,x,1);
A3_5_xx=diff(A3_5,x,2);
A3con_5=A3con_5_1+A3con_5_2+A3con_5_3+A3con_5_4+A3con_5_5+A3con_5_6;
A3con_5_x=diff(A3con_5,x,1);
A3con_5_xx=diff(A3con_5,x,2);
% *****************************************************第五次迭代四阶位移*********************************************************
A4_5_1=(U^4*beta^3*k^4*x*exp(-k*x*4i)*(4*k^2*x^2 + k*x*12i - 7))/384;
A4_5_2=-(U^6*beta^5*k^6*x*exp(-k*x*4i)*(90624*k^4*x^4 + k^3*x^3*796992i - 2158432*k^2*x^2 - k*x*2165820i + 766705))/188743680;
A4_5_3=(U^8*beta^7*k^8*x*exp(-k*x*4i)*(37208064*k^6*x^6 + k^5*x^5*408446976i - 2111832576*k^4*x^4 - k^3*x^3*6735309504i + 11618991776*k^2*x^2 + k*x*8841861252i - 2660997087))/4058744094720;
A4_5_4=-(U^10*beta^9*k^10*x*exp(-k*x*4i)*(2463498240*k^8*x^8 + k^7*x^7*20824473600i - 1495449600*k^6*x^6 + k^5*x^5*371672770560i - 822233707008*k^4*x^4 + k^3*x^3*497152192320i - 2869007878240*k^2*x^2 - k*x*2443707530460i + 696374390985))/15585577323724800;
A4_5_5=(U^12*beta^11*k^12*x*exp(-k*x*4i)*(116530348032*k^10*x^10 + k^9*x^9*938485481472i - 926445076480*k^8*x^8 + k^7*x^7*4056767447040i + 10463305318400*k^6*x^6 + k^5*x^5*41667909212160i + 24701653025280*k^4*x^4 + k^3*x^3*18559557508800i + 234568400220000*k^2*x^2 + k*x*247160437731900i - 73995986797425))/87777971487218073600;

A4_5=A4_5_1+A4_5_2+A4_5_3+A4_5_4+A4_5_5;
A4_5_x=diff(A4_5,x,1);
A4_5_xx=diff(A4_5,x,2);
% *****************************************************第五次迭代五阶位移*********************************************************
A5_5_1=(U^5*beta^4*k^5*x*exp(-k*x*5i)*(4125*k^3*x^3 + k^2*x^2*16400i - 20180*k*x - 6964i))/768000;
A5_5_2=-(U^7*beta^6*k^7*x*exp(-k*x*5i)*(47760000*k^5*x^5 + k^4*x^4*468864000i - 1609116000*k^3*x^3 - k^2*x^2*2427315600i + 1582610570*k*x + 388894761i))/235929600000;
A5_5_3=(U^9*beta^8*k^9*x*exp(-k*x*5i)*(4914000000*k^7*x^7 - k^6*x^6*5752800000i + 26806640000*k^5*x^5 - k^4*x^4*1174194084000i + 5373374039250*k^3*x^3 + k^2*x^2*8661722990550i - 5662873434085*k*x - 1377959125683i))/7927234560000000;
A5_5_4=(U^11*beta^10*k^11*x*exp(-k*x*5i)*(17010000000*k^9*x^9 + k^8*x^8*1723365000000i - 23401609875000*k^7*x^7 - k^6*x^6*126531618600000i + 315825423698750*k^5*x^5 + k^4*x^4*315578877733875i + 72355742890375*k^3*x^3 + k^2*x^2*388062102062600i - 265633567115595*k*x - 59690733451881i))/9512681472000000000;

A5_5=A5_5_1+A5_5_2+A5_5_3+A5_5_4;
A5_5_x=diff(A5_5,x,1);
A5_5_xx=diff(A5_5,x,2);
% *****************************************************解方程*********************************************************
sum_right=(beta/2)*simplify(A1_5_x*A1_5_xx+A1con_5_x*A3_5_xx+A1con_5_xx*A3_5_x+A2con_5_x*A4_5_xx+A2con_5_xx*A4_5_x+A3con_5_x*A5_5_xx+A3con_5_xx*A5_5_x);
param_right=coeffs(sum_right/exp(-2i*k*x),x);
A2_6=(c1*x^23+c2*x^22+c3*x^21+c4*x^20+c5*x^19+c6*x^18+c7*x^17+c8*x^16+c9*x^15+c10*x^14+c11*x^13+c12*x^12+c13*x^11+c14*x^10+c15*x^9+c16*x^8+c17*x^7+c18*x^6+c19*x^5+c20*x^4+c21*x^3+c22*x^2+c23*x)*exp(-2i*k*x);
A2_6_xx=diff(A2_6,x,2);
sum_left=-(4*k^2*A2_6+A2_6_xx);
param_left=coeffs(simplify(sum_left/exp(-2i*k*x)),x);
C=solve(param_left==param_right,[c1 c2 c3 c4 c5 c6 c7 c8 c9 c10 c11 c12 c13 c14 c15 c16 c17 c18 c19 c20 c21 c22 c23]);
A2_6=expand(subs(A2_6,C));