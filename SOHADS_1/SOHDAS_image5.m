% *****************************************************
% 文献与创新的对比
% *****************************************************
clc;clear;close all;
f=(2:0.1:20)*1e6;                                                  %发射超声频率f=2-20MHz
omega=2*pi*f;                                                    %角速度ω=2*π*f
c=1491;                                                               %水中的声速c=1491m/s
k=omega/c;                                                         %波数k=ω/c
t=5;                                                                     %时间取声波传播后的2s
x=0.07;                                                                %传播距离取0.07m
beta=6.88;                                                           %水中的非线性参数β=6.88
U=100e-9;                                                           %声源的震动幅度U=100nm
theta=omega*t-k*x;
% ********************************************************
% 创新
% ********************************************************
y2_2=(k^2*U^2*beta/8)*x.*cos(2*theta);
y2_2_amplitude_cos=(k^2*U^2*beta/8)*x;
y2_2_amplitude_sin=0;
y2_2_amplitude=((y2_2_amplitude_cos).^2+(y2_2_amplitude_sin).^2).^0.5;
y2_3=y2_2;
y2_3_amplitude_cos=y2_2_amplitude_cos;
y2_3_amplitude_sin=y2_2_amplitude_sin;
y2_3_amplitude=((y2_3_amplitude_cos).^2+(y2_3_amplitude_sin).^2).^0.5;
y2_4_a=y2_2;
y2_4_a_amplitude_cos=(k^2*U^2*beta/8)*x;
y2_4_a_amplitude_sin=0;
y2_4_b=(k^4*U^4*beta^3/24)*(-(k^2/4)*(x.^3).*cos(2*theta)+(9*k/8)*(x.^2).*sin(2*theta)+x.*cos(2*theta));
y2_4_b_amplitude_cos=(k^4*U^4*beta^3/24)*(-(k^2/4)*(x.^3)+x);
y2_4_b_amplitude_sin=(k^4*U^4*beta^3/24)*(9*k/8)*(x.^2);
y2_4_c=(k^6*U^6*beta^5/8192)*((7*k^4/5)*(x.^5).*cos(2*theta)-(3*k^3/4)*(x.^4).*sin(2*theta)+(259*k^2/36)*(x.^3).*cos(2*theta)+(643*k/48)*(x.^2).*sin(2*theta)+(1661/96)*x.*cos(2*theta));
y2_4_c_amplitude_cos=(k^6*U^6*beta^5/8192)*((7*k^4/5)*(x.^5)+(259*k^2/36)*(x.^3)+(1661/96)*x);
y2_4_c_amplitude_sin=(k^6*U^6*beta^5/8192)*(-(3*k^3/4)*(x.^4)+(643*k/48)*(x.^2));
y2_4=y2_4_a+y2_4_b+y2_4_c;
y2_4_amplitude_cos=y2_4_a_amplitude_cos+y2_4_b_amplitude_cos+y2_4_c_amplitude_cos;
y2_4_amplitude_sin=y2_4_a_amplitude_sin+y2_4_b_amplitude_sin+y2_4_c_amplitude_sin;
y2_4_amplitude=((y2_4_amplitude_cos).^2+(y2_4_amplitude_sin).^2).^0.5;
y2_5_a=y2_2;
y2_5_a_amplitude_cos=y2_2_amplitude_cos;
y2_5_a_amplitude_sin=y2_2_amplitude_sin;
y2_5_b=y2_4_b;
y2_5_b_amplitude_cos=y2_4_b_amplitude_cos;
y2_5_b_amplitude_sin=y2_4_b_amplitude_sin;
y2_5_c=-(U^6*beta^5*k^6/2949120)*(1728*k^4*(x.^5).*cos(2*theta)-8952*k^3*(x.^4).*sin(2*theta) - 9208*k^2*(x.^3).*cos(2*theta)-18042*k*(x.^2).*sin(2*theta) - 23299*x.*cos(2*theta));
y2_5_c_amplitude_cos=-(U^6*beta^5*k^6/2949120)*(1728*k^4*(x.^5) - 9208*k^2*(x.^3)- 23299*x);
y2_5_c_amplitude_sin=-(U^6*beta^5*k^6/2949120)*(-8952*k^3*(x.^4)-18042*k*(x.^2));
y2_5_d=(U^8*beta^7*k^8/211392921600)*(11512320*k^6*(x.^7).*cos(2*theta)+k^5*(x.^6)*10586240.*sin(2*theta)+ 86812992*k^4*(x.^5).*cos(2*theta)+k^3*(x.^4)*403709600.*sin(2*theta)+ 532493360*k^2*(x.^3).*cos(2*theta)+k*(x.^2)*153014750.*sin(2*theta) + 226904125*x.*cos(2*theta));
y2_5_d_amplitude_cos=(U^8*beta^7*k^8/211392921600)*(11512320*k^6*(x.^7)+ 86812992*k^4*(x.^5)+ 532493360*k^2*(x.^3)+ 226904125*x);
y2_5_d_amplitude_sin=(U^8*beta^7*k^8/211392921600)*(k^5*(x.^6)*10586240+k^3*(x.^4)*403709600+k*(x.^2)*153014750);
y2_5_e=-(U^10*beta^9*k^10/30440580710400)*(29191680*k^8*(x.^9).*cos(2*theta)-k^7*(x.^8)*83885760.*sin(2*theta)+745426560*k^6*(x.^7).*cos(2*theta)-k^5*(x.^6)*2746843680.*sin(2*theta)-109166736*k^4*(x.^5).*cos(2*theta)-k^3*(x.^4)*9346975680.*sin(2*theta)- 7403656120*k^2*(x.^3).*cos(2*theta)-k*(x.^2)*2079789390.*sin(2*theta)- 2370095805*x.*cos(2*theta));
y2_5_e_amplitude_cos=-(U^10*beta^9*k^10/30440580710400)*(29191680*k^8*(x.^9)+745426560*k^6*(x.^7)-109166736*k^4*(x.^5)- 7403656120*k^2*(x.^3)- 2370095805*x);
y2_5_e_amplitude_sin=-(U^10*beta^9*k^10/30440580710400)*(-k^7*(x.^8)*83885760-k^5*(x.^6)*2746843680-k^3*(x.^4)*9346975680-k*(x.^2)*2079789390);
y2_5_f=-(U^12*beta^11*k^12/685765402243891200)*(-3121348608*k^10*(x.^11).*cos(2*theta)+k^9*(x.^10)*30349541376.*sin(2*theta)+19383992320*k^8*(x.^9).*cos(2*theta)+k^7*(x.^8)*502196808960.*sin(2*theta)+1586121320960*k^6*(x.^7).*cos(2*theta)-k^5*(x.^6)*993841242240.*sin(2*theta)+ 3701692764000*k^4*(x.^5).*cos(2*theta)-k^3*(x.^4)*7696444371000.*sin(2*theta)- 3506369328000*k^2*(x.^3).*cos(2*theta)-k*(x.^2)*1310910158250.*sin(2*theta)- 827161317675*x.*cos(2*theta));
y2_5_f_amplitude_cos=-(U^12*beta^11*k^12/685765402243891200)*(-3121348608*k^10*(x.^11)+19383992320*k^8*(x.^9)+1586121320960*k^6*(x.^7)+ 3701692764000*k^4*(x.^5)- 3506369328000*k^2*(x.^3)- 827161317675*x);
y2_5_f_amplitude_sin=-(U^12*beta^11*k^12/685765402243891200)*(k^9*(x.^10)*30349541376+k^7*(x.^8)*502196808960-k^5*(x.^6)*993841242240-k^3*(x.^4)*7696444371000-k*(x.^2)*1310910158250);
y2_5=y2_5_a+y2_5_b+y2_5_c+y2_5_d+y2_5_e+y2_5_f;
y2_5_amplitude_cos=y2_5_a_amplitude_cos+y2_5_b_amplitude_cos+y2_5_c_amplitude_cos+y2_5_d_amplitude_cos+y2_5_e_amplitude_cos+y2_5_f_amplitude_cos;
y2_5_amplitude_sin=y2_5_a_amplitude_sin+y2_5_b_amplitude_sin+y2_5_c_amplitude_sin+y2_5_d_amplitude_sin+y2_5_e_amplitude_sin+y2_5_f_amplitude_sin;
y2_5_amplitude=((y2_5_amplitude_cos).^2+(y2_5_amplitude_sin).^2).^0.5;
A2_6_sin=(+(U^24*beta^23*k^45*x.^22*147)/247697979505377280000-(U^24*beta^23*k^43*x.^20*23005531)/285348072390194626560000-(U^24*beta^23*k^41*x.^18*162800085163)/34515702836317942028697600-(U^22*beta^21*k^41*x.^20*25438949)/13375690893290373120000-(U^24*beta^23*k^39*x.^16*1321359703975063)/11045024907621741449183232000-(U^22*beta^21*k^39*x.^18*1014967260121)/10834309623565202227200000-(U^24*beta^23*k^37*x.^14*164550058591182539)/151818887821127937010591334400+(U^22*beta^21*k^37*x.^16*827712258634633)/80896178522620176629760000000-(U^24*beta^23*k^35*x.^12*4002868262068508923)/848257912905349743297272217600+(U^20*beta^19*k^37*x.^18*1034789807)/3160006973539850649600+(U^22*beta^21*k^35*x.^14*484723538115975729869)/11325464993166824728166400000000+(U^24*beta^23*k^33*x.^10*519084615163926991)/528784153499438801016481382400+(U^20*beta^19*k^35*x.^16*2201394385781)/16853370525545870131200000+(U^22*beta^21*k^33*x.^12*430172432334490349117809)/794253389131179916001280000000000-(U^24*beta^23*k^31*x.^8*30415698309845335)/6267071448882237641676816384+(U^20*beta^19*k^33*x.^14*519864565121310889)/1769603905182316363776000000+(U^22*beta^21*k^31*x.^10*732734775275899140163572649)/190620813391483179840307200000000000-(U^18*beta^17*k^33*x.^16*641811223)/48765539715121152000+(U^24*beta^23*k^29*x.^6*889566871420488233)/7833839311102797052096020480+(U^20*beta^19*k^31*x.^12*49558122475400544919)/5170920502156119244800000000+(U^22*beta^21*k^29*x.^8*6432620025146140569083830309)/609986602852746175488983040000000000-(U^18*beta^17*k^31*x.^14*36528594902441)/46083435030789488640000-(U^24*beta^23*k^27*x.^4*4395738755305454657)/33424381060705267422276354048+(U^20*beta^19*k^29*x.^10*9515422290476338330969019)/99281673641397489500160000000000+(U^22*beta^21*k^27*x.^6*3693712883365125037797025843)/261422829794034075209564160000000000+(U^18*beta^17*k^29*x.^12*1902971017639709)/379200836824782077952000+(U^24*beta^23*k^25*x.^2*11250136487007854947)/100273143182115802266829062144+(U^20*beta^19*k^27*x.^8*21863412771355395144776951)/56732384937941422571520000000000-(U^16*beta^15*k^29*x.^14*2259769)/17779103021137920 +(U^22*beta^21*k^25*x.^4*334360866166987339281116611)/92950339482323226741178368000000000+(U^18*beta^17*k^27*x.^10*138285996239452487261)/369351464439722803200000000+(U^20*beta^19*k^25*x.^6*103830735569621327228623847)/226929539751765690286080000000000+(U^16*beta^15*k^27*x.^12*21264176950369)/411459241346334720000+(U^22*beta^21*k^23*x.^2*117864496505102677724859307)/61966892988215484494118912000000000+(U^18*beta^17*k^25*x.^8*68747065346713389197707)/17236401673853730816000000000+(U^20*beta^19*k^23*x.^4*2418062901892416338207233429)/8714094326467802506985472000000000+(U^16*beta^15*k^25*x.^10*15423662162842277)/11221615673081856000000+(U^18*beta^17*k^23*x.^6*6788352138342310755066743)/886443514655334727680000000000-(U^14*beta^13*k^25*x.^12*367228751)/4286033764024320+(U^20*beta^19*k^21*x.^2*482351310269248598112888973)/11618792435290403342647296000000000+(U^16*beta^15*k^23*x.^8*44183759743470878603)/2693187761539645440000000+(U^18*beta^17*k^21*x.^4*946911383502197001009943)/210119944214597861376000000000-(U^14*beta^13*k^23*x.^10*9261654413)/29222957481984000+(U^16*beta^15*k^21*x.^6*1696063920039639262367)/23084466527482675200000000+(U^18*beta^17*k^19*x.^2*5204355126159467508705527)/2521439330575174336512000000000+(U^14*beta^13*k^21*x.^8*8377674629110747)/280540391827046400000+(U^16*beta^15*k^19*x.^4*14603624691625940720291)/295481171551778242560000000+(U^12*beta^11*k^21*x.^10*88041929)/25367150592000+(U^14*beta^13*k^19*x.^6*679138411186509481)/2404631929946112000000 +(U^16*beta^15*k^17*x.^2*392175576915675189675953)/29548117155177824256000000000+(U^12*beta^11*k^19*x.^8*16928988533)/270582939648000+(U^14*beta^13*k^17*x.^4*80738287357979564459)/213745060439654400000000+(U^12*beta^11*k^17*x.^6*46269806995781)/62620623175680000+(U^14*beta^13*k^15*x.^210836462500998434495931)/76948221758275584000000000-(U^10*beta^9*k^17*x.^8*243161)/15099494400+(U^12*beta^11*k^15*x.^4*106749853219510619)/50096498540544000000+(U^10*beta^9*k^15*x.^6*126879461)/217432719360+(U^12*beta^11*k^13*x.^2*1109031960712261619)/2003859941621760000000+(U^10*beta^9*k^13*x.^4*3713044525703)/869730877440000+(U^8*beta^7*k^13*x.^6*135313)/235929600+(U^10*beta^9*k^11*x.^2*81806798160803)/34789235097600000+(U^8*beta^7*k^11*x.^4*39866843)/11324620800+(U^8*beta^7*k^9*x.^2*11571146989)/1358954496000-(U^6*beta^5*k^9*x.^4*19)/3072+(U^6*beta^5*k^7*x.^2*977)/18432+(U^4*beta^3*k^5*x.^2*3)/64).*sin(2*theta);
A2_6_cos=(-(11058691883501748067*U^24*beta^23*k^24*x)/200546286364231604533658124288-(23572893475709351172922889*U^22*beta^21*k^22*x)/41311261992143656329412608000000000+(175445574324350929539581543*U^20*beta^19*k^20*x)/4647516974116161337058918400000000+(20831574451151030006061313*U^18*beta^17*k^18*x)/45385907950353138057216000000000+(615197974632315816881407*U^16*beta^15*k^16*x)/59096234310355648512000000000+(12933031819087527983129*U^14*beta^13*k^14*x)/153896443516551168000000000+(4451056128492440963*U^12*beta^11*k^12*x)/12023159649730560000000+(1193062618308793*U^10*beta^9*k^10*x)/626206231756800000+(57932918153*U^8*beta^7*k^8*x)/8153726976000+(3145*U^6*beta^5*k^6*x)/110592+(U^4*beta^3*k^4*x)/24+(U^2*beta*k^2*x)/8-(1029*U^24*beta^23*k^46*x.^23)/1958362150464389120000-(1683217*U^24*beta^23*k^44*x.^21)/21887494189020610560000-(378098211901*U^24*beta^23*k^42*x.^19)/143722041842784937181184000+(3066649*U^22*beta^21*k^42*x.^21)/15604972708838768640000-(1265953351715803*U^24*beta^23*k^40*x.^17)/35206016893044300869271552000+(474691630027*U^22*beta^21*k^40*x.^19)/41170376569547768463360000-(386215084420681151*U^24*beta^23*k^38*x.^15)/3131264561310763700843446272000+(133914799849981*U^22*beta^21*k^38*x.^17)/2865072989342797922304000000+(9474635586413565541*U^24*beta^23*k^36*x.^13)/12405771976240739995722606182400-(84591157*U^20*beta^19*k^38*x.^19)/3573817410551021568000-(5159717245187738269*U^22*beta^21*k^36*x.^15)/4247049372437559273062400000000+(741230647015421023*U^24*beta^23*k^34*x.^11)/67860633032427979463781777408+(26191232941*U^20*beta^19*k^36*x.^17)/238756082445233160192000+(71675975660480704825321*U^22*beta^21*k^34*x.^13)/7571882309717248532545536000000000+(39428549026701552667*U^24*beta^23*k^32*x.^9)/2220893444697642964269221806080-(316507876940923097*U^20*beta^19*k^34*x.^15)/2654405857773474545664000000-(4309298785628584501466171*U^22*beta^21*k^32*x.^11)/24962249372694225931468800000000000+(250220639*U^18*beta^17*k^34*x.^17)/310880315683897344000+(3206341080047303297*U^24*beta^23*k^30*x.^7)/41127656383289684523504107520-(84973970357639706403*U^20*beta^19*k^32*x.^13)/28169205021269525790720000000-(1084743725404829554257743*U^22*beta^21*k^30*x.^9)/4084731715531782425149440000000000+(141394804931*U^18*beta^17*k^32*x.^15)/2618376990385766400000-(72679947090258967979*U^24*beta^23*k^28*x.^5)/752048573865868517001217966080-(224186305470483777201421*U^20*beta^19*k^30*x.^11)/9100820083794769870848000000000+(2320983478746968944493985959*U^22*beta^21*k^28*x.^7)/914979904279119263233474560000000000-(5872449031765553*U^18*beta^17*k^30*x.^13)/3423340888001504870400000+(93710314229780848661*U^24*beta^23*k^26*x.^3)/601638859092694813600974372864-(11179056993979291582757693*U^20*beta^19*k^28*x.^9)/148922510462096234250240000000000-(174569389*U^16*beta^15*k^30*x.^15)/3000223634817024000+(2061179603569569897146264053*U^22*beta^21*k^26*x.^5)/697127546117424200558837760000000000-(26865157174091137243*U^18*beta^17*k^28*x.^11)/237000523015488798720000000+(45750328721068101140710853*U^20*beta^19*k^26*x.^7)/4765520334787079496007680000000000-(455610874933*U^16*beta^15*k^28*x.^13)/29716500763901952000+(491980453966857846140964277*U^22*beta^21*k^24*x.^3)/111540407378787872089414041600000000-(6909735604829778493627*U^18*beta^17*k^26*x.^9)/6205104602587343093760000000+(82431641344967589498125297*U^20*beta^19*k^24*x.^5)/544630895404237656686592000000000-(63064535118463*U^16*beta^15*k^26*x.^11)/146949729052262400000-(28632087520037320266763*U^18*beta^17*k^24*x.^7)/38303114830786068480000000000+(116072311*U^14*beta^13*k^26*x.^13)/7738672073932800+(32343588001367327449831079*U^20*beta^19*k^22*x.^3)/363087263602825104457728000000000-(327669747416417417*U^16*beta^15*k^24*x.^9)/67329694038491136000000+(117529523789433112625497*U^18*beta^17*k^22*x.^5)/110805439331916840960000000000+(375294191*U^14*beta^13*k^24*x.^11)/1195879956480000-(2773074670383853538819*U^16*beta^15*k^22*x.^7)/161591265692378726400000000+(6426608093533224587172661*U^18*beta^17*k^20*x.^3)/2127464435172803346432000000000-(807256483223*U^14*beta^13*k^22*x.^9)/4208105877405696000+(806280625040180047331*U^16*beta^15*k^20*x.^5)/38474110879137792000000000-(333007*U^12*beta^11*k^22*x.^11)/387553689600-(36346884406812853*U^14*beta^13*k^20*x.^7)/1052026469351424000000+(61134290604876736007947*U^16*beta^15*k^18*x.^3)/2770135983297921024000000000-(4514683*U^12*beta^11*k^20*x.^9)/228304355328+(14111892657350357159*U^14*beta^13*k^18*x.^5)/120231596497305600000000-(5883032448323*U^12*beta^11*k^18*x.^7)/36528696852480000+(68951724302903104139*U^14*beta^13*k^16*x.^3)/450868486864896000000000+(14477*U^10*beta^9*k^18*x.^9)/880803840-(376982615104189*U^12*beta^11*k^16*x.^5)/3131031158784000000+(4601921*U^10*beta^9*k^16*x.^7)/22649241600+(26640623375647289*U^12*beta^11*k^14*x.^3)/20873541058560000000+(42568537997*U^10*beta^9*k^14*x.^5)/54358179840000-(6883*U^8*beta^7*k^14*x.^7)/82575360+(2753637078071*U^10*beta^9*k^12*x.^3)/611529523200000+(89449*U^8*beta^7*k^12*x.^5)/157286400+(260367361*U^8*beta^7*k^10*x.^3)/56623104000+(U^6*beta^5*k^10*x.^5)/1920-(265*U^6*beta^5*k^8*x.^3)/9216-(U^4*beta^3*k^6*x.^3)/96).*cos(2*theta);
y2_6_amplitude_cos=A2_6_cos./cos(2*theta);
y2_6_amplitude_sin=A2_6_sin./sin(2*theta);
y2_6_amplitude=((y2_6_amplitude_cos).^2+(y2_6_amplitude_sin).^2).^0.5;
figure(1);
plot(x,u2_6_amplitude/U);
hold on
plot(x,y2_3_amplitude/U);
ylim([0 1])
legend("第六次迭代二阶位移","第三次迭代二阶位移");